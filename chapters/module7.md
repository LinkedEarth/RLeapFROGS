---
title: 'Module 7: Packaging your software for sharing in R'
description:
  "This module introduces key concepts for packaging your research software using R."
prev: /module6
next: null
type: chapter
id: 7
---

<exercise id="1" title="To package or not to package">

# 1. What are packages?

An R package is a structured collection of R functions, documentation, tests, and data organized for reuse. At its core, a package is a directory with a `DESCRIPTION` file and `R/` folder containing function definitions. It can also include vignettes, tests, and documentation.

For a gentle introduction, see [R Packages book by Hadley Wickham](https://r-pkgs.org/).

# 2. Why package?

Packaging helps you:
- Reuse code across projects
- Share work with colleagues and the broader R community
- Track development using tools like git
- Improve reproducibility and reduce errors
- Create documentation automatically

# 3. When not to package

You may not need to package your code if:
* You're writing a short, one-off script
* It's a personal analysis for a specific paper
* You're still rapidly prototyping
* You’re distributing code in another format (e.g., R Markdown or Quarto reports)
* The code is too specialized to warrant reuse

As a rule of thumb: workflows for a single paper do not need to be packaged, but helper functions supporting the workflow might.

</exercise>

<exercise id="2" title="Sharing your package">

# 1. Software repositories

Your code should live in a version-controlled repository like GitHub or GitLab. These platforms support collaboration, bug tracking, and continuous integration. You can learn more in [Module 5](https://linked.earth/LeapFROGS/module5).

# 2. Software registries

Registries make your code discoverable. In R, the main registry is:
* [CRAN](https://cran.r-project.org) — the central repository for R packages.
Other platforms include:
* [r-universe](https://r-universe.dev) — allows automated documentation and builds for packages hosted on GitHub.
* [Bioconductor](https://www.bioconductor.org) — for bioinformatics-related tools.

</exercise>

<exercise id="3" title="Packaging your software">

# 1. Getting started

## User APIs

Think about what tasks users will want to perform with your package. Your public-facing functions should support these tasks clearly and concisely. Hide internal logic unless necessary.

Use `usethis::use_package("dplyr")` or similar to manage dependencies and define your interface with care. Follow conventions—e.g., verbs for function names (`plot_data()`, `clean_names()`).

## Package structure

Use `usethis::create_package()` to set up a clean structure. A typical R package might look like this:

```
myPackage/
├── DESCRIPTION
├── NAMESPACE
├── R/
│   ├── utils.R
│   └── plotting.R
├── man/               # Help files generated by roxygen2
├── tests/
├── vignettes/
└── README.md
```

## Building your first package

Tools to use:
- [`devtools`](https://devtools.r-lib.org) — to streamline package development
- [`roxygen2`](https://roxygen2.r-lib.org) — to write documentation inline with your functions
- [`usethis`](https://usethis.r-lib.org) — to set up packages and files easily

A detailed guide is available at [https://r-pkgs.org](https://r-pkgs.org).

# 2. Documentation

Use roxygen2 comments (`#'`) to document your functions. Run `devtools::document()` to generate help files.

To build websites from your docs:
- [`pkgdown`](https://pkgdown.r-lib.org): Creates a static website from your documentation and vignettes

# 3. Tutorials

Use R Markdown or Quarto to create tutorials demonstrating how to use your package in real workflows.

Example tools:
- [`learnr`](https://rstudio.github.io/learnr) — interactive tutorials in R Markdown
- [`bookdown`](https://bookdown.org) — write books/tutorials
- [`Binder`](https://mybinder.org) — run notebooks interactively online

Examples:
- [Pyleoclim tutorials](http://linked.earth/PyleoTutorials/intro.html)
- [LinkedEarth Quarto books](http://linked.earth/PaleoBooks/index.html)

# 4. Testing and CI

Use `testthat` to write unit tests. Start with `usethis::use_testthat()` and write tests in `tests/testthat/`.

To automate tests on GitHub:
- Add a GitHub Actions workflow using `usethis::use_github_action("check-standard")`

# 5. Code review

Code reviews improve quality and catch issues early. Share your package via GitHub and invite collaborators to open issues and pull requests.

Consider submitting to [rOpenSci](https://ropensci.org/software-review/) for peer review of your scientific R package.

</exercise>

<exercise id="4" title="Publishing your package">

# 1. Publishing on CRAN

See [r-pkgs.org/publishing.html](https://r-pkgs.org/publishing.html) for how to submit to CRAN. Check your package with:

```r
devtools::check()
```

# 2. Automating releases

Use GitHub Actions to automate versioning, documentation, and test runs. Consider `usethis::use_release_issue()` to guide your release process.

You can also build and host Docker containers using GitHub Actions if needed.

</exercise>

<exercise id="5" title="Additional Resources">

- [rOpenSci packaging guide](https://devguide.ropensci.org/)
- [The R Packages Book](https://r-pkgs.org/)
- [CRAN Repository Policy](https://cran.r-project.org/web/packages/policies.html)
- [pkgdown documentation](https://pkgdown.r-lib.org/)
- [testthat documentation](https://testthat.r-lib.org/)

</exercise>

<exercise id="7" title="Test your understanding">

Question: What is an R package?

<choice id="07-01">
<opt text="A single R script with functions.">
That describes a script, not a package.
</opt>
<opt text="A folder with a DESCRIPTION file and R/ directory.", correct=True>
This is the minimal structure of an R package.
</opt>
<opt text="A zipped archive of code.">
Not the common form for development or sharing.
</opt>
<opt text="Just a GitHub repository.">
The repository helps host it, but it's not a package by itself.
</opt>
</choice>

Question: Why package your code?

<choice id="07-02">
<opt text="To make it easier to reuse, test, and share.", correct=True>
Packaging improves reusability and maintainability.
</opt>
<opt text="To run code faster.">
Packaging doesn’t directly improve speed.
</opt>
<opt text="To hide your code.">
R packages are public by design.
</opt>
<opt text="To avoid using git.">
In fact, git is highly recommended for package development.
</opt>
</choice>

Question: What tool helps automate package setup?

<choice id="07-03">
<opt text="usethis", correct=True>
This package automates many setup tasks.
</opt>
<opt text="base R only.">
Base R doesn’t provide these development helpers.
</opt>
<opt text="readr">
`readr` helps read data, not create packages.
</opt>
<opt text="tidyverse">
`tidyverse` is a meta-package, not for development setup.
</opt>
</choice>

</exercise>

<exercise id="8" title="Hands-on exercise">

* Use `usethis::create_package("myPkg")` to start a new package.
* Add a function in the `R/` folder.
* Document it with `roxygen2` comments and run `devtools::document()`.
* Write a test using `testthat`.
* Push to GitHub and try creating a `pkgdown` site.

</exercise>
